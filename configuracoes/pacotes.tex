% REFERÊNCIAS------------------------------------------------------------------
\usepackage[%
    alf,                      
    abnt-cite-str=lower,
    abnt-cite-style=lower,      
    bibjustif,
    recuo=0cm,
    abnt-url-package=url,       % Utiliza o pacote url
    abnt-refinfo=yes,           % Utiliza o estilo bibliográfico abnt-refinfo
    abnt-etal-cite=3,
    abnt-etal-list=3,
    abnt-thesis-year=final
]{abntex2cite}                  % Configura as citações bibliográficas conforme a norma ABNT

% PACOTES----------------------------------------------------------------------
\usepackage[utf8]{inputenc}                                 % Codificação do documento
\usepackage[T1]{fontenc}                                    % Seleção de código de fonte
\usepackage{booktabs}                                       % Réguas horizontais em tabelas
\usepackage{color, colortbl}                                % Controle das cores
\usepackage{float}                                          % Necessário para tabelas/figuras em ambiente multi-colunas
\usepackage{graphicx}                                       % Inclusão de gráficos e figuras
\usepackage{icomma}                                         % Uso de vírgulas em expressões matemáticas
\usepackage{indentfirst}                                    % Indenta o primeiro parágrafo de cada seção
\usepackage{microtype}                                      % Melhora a justificação do documento
\usepackage{multirow, array}                                % Permite tabelas com múltiplas linhas e colunas
\usepackage{subeqnarray}                                    % Permite subnumeração de equações
\usepackage{lastpage}                                       % Para encontrar última página do documento
\usepackage{verbatim}                                       % Permite apresentar texto tal como escrito no documento, ainda que sejam comandos Latex
\usepackage{amsfonts, amssymb, amsmath}                     % Fontes e símbolos matemáticos
\usepackage[algoruled, portuguese]{algorithm2e}             % Permite escrever algoritmos em português
%\usepackage[scaled]{helvet}                                % Usa a fonte Helvetica
\usepackage{times}                                          % Usa a fonte Times
%\usepackage{palatino}                                      % Usa a fonte Palatino
%\usepackage{lmodern}                                       % Usa a fonte Latin Modern
\usepackage[bottom]{footmisc}                               % Mantém as notas de rodapé sempre na mesma posição
\usepackage{ae, aecompl}                                    % Fontes de alta qualidade
\usepackage{latexsym}                                       % Símbolos matemáticos
\usepackage{lscape}                                         % Permite páginas em modo "paisagem"
%\usepackage{picinpar}                                      % Dispor imagens em parágrafos
%\usepackage{scalefnt}                                      % Permite redimensionar tamanho da fonte
%\usepackage{subfig}                                        % Posicionamento de figuras
%\usepackage{upgreek}                                       % Fonte letras gregas
\usepackage{amsthm}

% Redefine a fonte para uma fonte similar a Arial (fonte Helvetica)
\renewcommand*\familydefault{\sfdefault}

% Define o estilo "theorem" (negrito, itálico)
\theoremstyle{plain}
\newtheorem{teorema}{Teorema}
\newtheorem{axioma}[teorema]{Axioma}     % Numerado junto com teorema
\newtheorem{lema}[teorema]{Lema}         % Numerado junto com teorema
\newtheorem{corolario}[teorema]{Corolário} % Numerado junto com teorema

% Define o estilo "definition" (negrito, reto)
\theoremstyle{definition}
\newtheorem{definicao}[teorema]{Definição} % Numerado junto com teorema
\newtheorem{exemplo}[teorema]{Exemplo}     % Numerado junto com teorema

% Define o estilo "remark" (itálico, reto)
\theoremstyle{remark}
\newtheorem{remark}{Nota} % Numerado separadamente

% Altera o nome padrão "Proof" do ambiente 'proof' para "Prova"
\renewcommand{\proofname}{Prova}

\definecolor{DarkModeBG}{gray}{0.15}    % Fundo (Cinza bem escuro)
\definecolor{DarkModeText}{gray}{0.95}  % Texto (Cinza bem claro)
\definecolor{DarkModeLink}{rgb}{0.345, 0.651, 1.0} % Link (Azul claro)

% Comando \linkcite{<texto>}{<chave-bib>}
% Cria links separados para o texto e o ano, deixando a pontuação de fora.
% Formato de saída: (<texto>, <ano>)
% \makeatletter
% \newcommand{\linkcite}[3][]{%
%   (%
%   \hyper@natlinkstart{#3}#2\hyper@natlinkend,%
%   ~\hyper@natlinkstart{#3}\citeyear{#3}\hyper@natlinkend%
%   \@ifnotempty{#1}{, p.~#1}
%   )%
% }
% \makeatother

\makeatletter

% 1. Comando principal: verifica o argumento opcional [pagina]
\def\linkcite{\@ifnextchar[{\@linkciteopt}{\@linkcitenormal}}

% 2. Chamado se [pagina] for fornecido: \linkcite[pagina]{texto1}{bibitem1}...
\def\@linkciteopt[#1]#2#3{%
  (%
  \hyper@natlinkstart{#3}#2\hyper@natlinkend,%
  ~\hyper@natlinkstart{#3}\citeyear{#3}\hyper@natlinkend%
  % Inicia o loop, passando a página (#1)
  \@linkciteloop{#1}%
}

% 3. Chamado se [pagina] NÃO for fornecido: \linkcite{texto1}{bibitem1}...
\def\@linkcitenormal#1#2{%
  (%
  \hyper@natlinkstart{#2}#1\hyper@natlinkend,%
  ~\hyper@natlinkstart{#2}\citeyear{#2}\hyper@natlinkend%
  % Inicia o loop, passando uma página vazia ({})
  \@linkciteloop{}%
}

% 4. A MACRO RECURSIVA (LOOP)
%    #1 = a página (pode estar vazia)
\def\@linkciteloop#1{%
  % Verifica se o próximo token é um '{' (início de um novo par)
  \@ifnextchar\bgroup{%
    % Se SIM, chama a macro de processo
    \@linkciteprocess{#1}%
  }{%
    % Se NÃO, chama a macro final
    \@linkciteend{#1}%
  }%
}

% 5. Macro de processo (imprime o próximo par e continua o loop)
%    #1 = a página, #2 = textoN, #3 = bibitemN
\def\@linkciteprocess#1#2#3{%
  ; % Imprime o separador
  ~\hyper@natlinkstart{#3}#2\hyper@natlinkend,%
  ~\hyper@natlinkstart{#3}\citeyear{#3}\hyper@natlinkend%
  % Chama o loop novamente para verificar se há mais
  \@linkciteloop{#1}%
}

% 6. Macro final (termina o comando)
%    #1 = a página
\def\@linkciteend#1{%
  % Imprime a página se ela foi fornecida
  \@ifnotempty{#1}{, p.~#1}%
  % Fecha o parêntese
  )%
}

\makeatother